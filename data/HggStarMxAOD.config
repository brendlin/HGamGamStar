#######################
#
#  Settings for default MxAOD production
#  intended for data and nominal MC samples
#  - produces very small MxAOD files:
#    no systematics, not the full list of variables
#

  # Release 20 base configuraiton
BaseConfig:                 HGamAnalysisFramework/HGamRel21.config

  # Need class access mode to avoid EventInfo corruption
xAODAccessMode:             class

  # Common MxAOD settings, including which variables to save  for each object
Include:                    HGamTools/MxAODCommon.config
# +Include:                   HGamAnalysisFramework/MCSamples.config

HgammaAnalysis.UseHardestVertex:                 YES

  # At what stage to save the events
  # cut definitions are in HGamTools/HGamCutflowAndMxAOD.h
  # ALLEVTS=3, TRIGGER=4, GRL=5, DQ=6, VERTEX=7, TWO_LOOSE_GAM=8, AMBIGUITY=9,
  # TRIG_MATCH=10, GAM_TIGHTID=11, GAM_ISOLATION=12, RELPTCUTS=13, MASSCUT=14, PASSALL=15
  #
  # Require preselection (two loose photons that fulfill ambiguity)
SkimmingCut:                9

  # Whether to save the good objects (xAOD format)
  # See MxAODCommon.config for which variables
  # are saved for each object
SaveObjects:		        YES

  # whether to save truth objects and variables
SaveTruthObjects:	        YES

SaveDetailedVariables:          NO
SaveTruthVariables:	        YES

  # Save systematic variations
ApplySystematicVariations:      NO

# For now turn off, until these are updated in HGamCore
EventHandler.CheckTriggerMatching: NO

#
########################

# Disabled triggers for now:
# HLT_mu60_0eta105_msonly is 2015 and 2017 only - skipping for now.
# (2017, but not in derivaiton: +EventHandler.RequiredTriggers: HLT_mu22_mu8noL1_calotag_0eta010)
# HLT_2e17_lhvloose_nod0_L12EM15VHI : they are not sure how to deal with this yet.

# Electron triggers (2015, 2016, 2017)
EventHandler.RequiredTriggers:  HLT_e24_lhmedium_L1EM20VH      HLT_e60_lhmedium      HLT_e120_lhloose      HLT_2e12_lhloose_L12EM10VH
+EventHandler.RequiredTriggers: HLT_e26_lhtight_nod0_ivarloose HLT_e60_lhmedium_nod0 HLT_e140_lhloose_nod0 HLT_2e17_lhvloose_nod0
+EventHandler.RequiredTriggers:                                                                            HLT_2e24_lhvloose_nod0
# Muon triggers (2015, 2016, 2017)
+EventHandler.RequiredTriggers: HLT_mu20_iloose_L1MU15 HLT_mu40 HLT_2mu10 HLT_mu18_mu8noL1
+EventHandler.RequiredTriggers: HLT_mu26_ivarmedium    HLT_mu50 HLT_2mu14 HLT_mu22_mu8noL1
# Electron-photon and merged: (2015, 2016, 2017)
# +EventHandler.RequiredTriggers: HLT_e20_lhmedium_g35_loose
# +EventHandler.RequiredTriggers:                            HLT_e20_lhmedium_nod0_g35_loose
# +EventHandler.RequiredTriggers:                                                            HLT_e25_mergedtight_g35_medium_Heg

EventHandler.TriggerMatchType.HLT_e24_lhmedium_L1EM20VH:      SingleElectron
EventHandler.TriggerMatchType.HLT_e26_lhtight_nod0_ivarloose: SingleElectron
EventHandler.TriggerMatchType.HLT_e60_lhmedium:               SingleElectron
EventHandler.TriggerMatchType.HLT_e60_lhmedium_nod0:          SingleElectron
EventHandler.TriggerMatchType.HLT_e120_lhloose:               SingleElectron
EventHandler.TriggerMatchType.HLT_e140_lhloose_nod0:          SingleElectron
EventHandler.TriggerMatchType.HLT_2e12_lhloose_L12EM10VH:     DiElectron
EventHandler.TriggerMatchType.HLT_2e17_lhvloose_nod0:         DiElectron
EventHandler.TriggerMatchType.HLT_2e24_lhvloose_nod0:         DiElectron

EventHandler.TriggerMatchType.HLT_mu20_iloose_L1MU15:         SingleMuon
EventHandler.TriggerMatchType.HLT_mu26_ivarmedium:            SingleMuon
EventHandler.TriggerMatchType.HLT_mu40:                       SingleMuon
EventHandler.TriggerMatchType.HLT_mu50:                       SingleMuon
EventHandler.TriggerMatchType.HLT_2mu10:                      DiMuon
EventHandler.TriggerMatchType.HLT_2mu14:                      DiMuon
EventHandler.TriggerMatchType.HLT_mu18_mu8noL1:               DiMuon
EventHandler.TriggerMatchType.HLT_mu22_mu8noL1:               DiMuon

EventHandler.TriggerThresholds.HLT_e24_lhmedium_L1EM20VH:      27
EventHandler.TriggerThresholds.HLT_e26_lhtight_nod0_ivarloose: 27
EventHandler.TriggerThresholds.HLT_e60_lhmedium:               61
EventHandler.TriggerThresholds.HLT_e60_lhmedium_nod0:          61
EventHandler.TriggerThresholds.HLT_e120_lhloose:              121
EventHandler.TriggerThresholds.HLT_e140_lhloose_nod0:         141
EventHandler.TriggerThresholds.HLT_2e12_lhloose_L12EM10VH:     25 25
EventHandler.TriggerThresholds.HLT_2e17_lhvloose_nod0:         25 25
EventHandler.TriggerThresholds.HLT_2e24_lhvloose_nod0:         25 25

EventHandler.TriggerThresholds.HLT_mu20_iloose_L1MU15:         27
EventHandler.TriggerThresholds.HLT_mu26_ivarmedium:            27
EventHandler.TriggerThresholds.HLT_mu40:                       51
EventHandler.TriggerThresholds.HLT_mu50:                       51
EventHandler.TriggerThresholds.HLT_2mu10:                      15
EventHandler.TriggerThresholds.HLT_2mu14:                      15
EventHandler.TriggerThresholds.HLT_mu18_mu8noL1:               23 9
EventHandler.TriggerThresholds.HLT_mu22_mu8noL1:               23 9

EventHandler.TriggerYear.HLT_e24_lhmedium_L1EM20VH:       2015
EventHandler.TriggerYear.HLT_e60_lhmedium:                2015
EventHandler.TriggerYear.HLT_e120_lhloose:                2015
EventHandler.TriggerYear.HLT_2e12_lhloose_L12EM10VH:      2015

EventHandler.TriggerYear.HLT_e26_lhtight_nod0_ivarloose:  2016
EventHandler.TriggerYear.HLT_e60_lhmedium_nod0:           2016
EventHandler.TriggerYear.HLT_e140_lhloose_nod0:           2016
EventHandler.TriggerYear.HLT_2e17_lhvloose_nod0:          2016

EventHandler.TriggerYear.HLT_2e24_lhvloose_nod0:          2017

##################################
# Truth settings (MC only)

TruthHandler.Electrons.PtPreCutGeV:            9.0
TruthHandler.Photons.PtPreCutGeV:              9.0
TruthHandler.Muons.PtPreCutGeV:                9.0

##################################
# Photon calibration & smearing settings
# that are DIFFERENT from HGamRel21.config

PhotonHandler.Selection.PtPreCutGeV:                9.0


##################################
# Electron calibration & smearing settings

ElectronHandler.Selection.PtPreCutGeV:           9.0


##################################
# Muon calibration & smearing settings

MuonHandler.Selection.PtCutGeV:                  9.0


##################################
# What to save in the output MxAOD

MxAOD.Variables.Jet:               pt.eta.phi.m.DetectorEta.Jvt.SF_jvt.passFJVT.HadronConeExclTruthLabelID

MxAOD.Variables.EventInfo:         runNumber.eventNumber.averageInteractionsPerCrossing.eventTypeBitmask.mcChannelNumber.mcEventWeights.DFCommonJets_eventClean_LooseBad.DFCommonJets_isBadBatman.HTXS_prodMode.HTXS_errorCode
